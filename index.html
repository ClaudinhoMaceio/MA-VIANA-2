<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Sistema de Controle de Medi√ß√£o - M.A VIANA LOCA√á√ïES</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Sistema completo de controle de medi√ß√£o com exporta√ß√£o de relat√≥rios e assinatura digital">
    <meta name="theme-color" content="#007bff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Controle de Medi√ß√£o">
    <meta name="msapplication-TileColor" content="#007bff">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="images/gerar_icone.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/gerar_icone.png">
    <link rel="apple-touch-icon" sizes="180x180" href="images/gerar_icone.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="style.css?v=4.0">
    
    <!-- Font Awesome para √≠cones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Cabe√ßalho do Sistema -->
        <div class="header">
            <div class="sistema-titulo">
                <div class="logo-titulo">
                    <div class="logo-lateral-titulo" id="logo-lateral" style="width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.2); margin: 0 auto 15px;">
                        <img src="images/gerar_icone.png" alt="Logo MV" style="width: 100%; height: 100%; object-fit: cover;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="80" height="80" style="display: none;">
                            <circle cx="32" cy="32" r="30" fill="#007bff" stroke="#0056b3" stroke-width="2"/>
                            <g fill="white">
                                <rect x="12" y="40" width="40" height="3" rx="1.5"/>
                                <circle cx="16" cy="42" r="2"/>
                                <circle cx="24" cy="38" r="2"/>
                                <circle cx="32" cy="35" r="2"/>
                                <circle cx="40" cy="32" r="2"/>
                                <circle cx="48" cy="30" r="2"/>
                                <path d="M16,42 L24,38 L32,35 L40,32 L48,30" stroke="white" stroke-width="2" fill="none"/>
                                <path d="M20,20 L20,45 L24,45 L24,28 L28,35 L32,28 L36,35 L40,28 L40,45 L44,45 L44,20 L38,20 L32,30 L26,20 Z" fill="white"/>
                            </g>
                        </svg>
                    </div>
                </div>
                <div class="titulo-com-logo">
                    <h1><i class="fas fa-chart-line"></i> CONTROLE DE MEDI√á√ÉO</h1>
                </div>
                <h2>M.A VIANA LOCA√á√ïES E SERVI√áOS - ME</h2>
                <div class="status-bar" style="display: none;">
                    <span id="connection-status" class="status-online">
                        <i class="fas fa-wifi"></i> Online
                    </span>
                    <span class="pwa-info">
                        <i class="fas fa-mobile-alt"></i> PWA Dispon√≠vel
                    </span>
                    <span class="debug-info">
                        <i class="fas fa-bug"></i> Debug Ativo
                    </span>
                </div>
            </div>
            <div class="header-actions">
                <button id="toggle-dark-mode" class="btn-dark-mode" title="Alternar modo noturno">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
        
        <!-- Informa√ß√µes da Empresa -->
            <div class="empresa-info">
                <div class="info-row">
                    <div class="info-item">
                        <label><i class="fas fa-building"></i> <strong>CNPJ:</strong></label>
                        <input type="text" id="cnpj-empresa" value="14.251.442/0001-15" class="campo-editavel" data-validate="cnpj" placeholder="XX.XXX.XXX/XXXX-XX">
                    </div>
                    <div class="info-item">
                        <label><i class="fas fa-industry"></i> <strong>NOME DA EMPRESA:</strong></label>
                        <input type="text" id="nome-empresa" value="M.A VIANA LOCA√á√ïES E SERVI√áOS - ME" class="campo-editavel">
                    </div>
                    <div class="info-item">
                        <label><i class="fas fa-map-marker-alt"></i> <strong>ENDERECO OBRA:</strong></label>
                        <input type="text" id="endereco-obra" value="" class="campo-editavel" placeholder="Digite o endere√ßo da obra">
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-item">
                        <label><i class="fas fa-road"></i> <strong>Rua:</strong></label>
                        <input type="text" id="rua-empresa" value="Rua Desembargador Auro Cerqueira Leite, 36" class="campo-editavel">
                    </div>
                    <div class="info-item">
                        <label><i class="fas fa-city"></i> <strong>Cidade:</strong></label>
                        <input type="text" id="cidade-empresa" value="Cidade Kemel - S√£o Paulo, SP" class="campo-editavel">
                    </div>
                    <div class="info-item">
                        <label><i class="fas fa-mail-bulk"></i> <strong>CEP:</strong></label>
                        <input type="text" id="cep-empresa" value="08130-410" class="campo-editavel">
                    </div>
                </div>
            </div>
            
            <!-- Informa√ß√µes do Cliente -->
            <div class="cliente-info">
                <div class="info-row">
                    <div class="info-item">
                        <label><i class="fas fa-id-card"></i> <strong>CNPJ CLIENTE:</strong></label>
                        <input type="text" id="cnpj-cliente" class="campo-editavel" placeholder="XX.XXX.XXX/XXXX-XX" data-validate="cnpj">
                    </div>
                    <div class="info-item">
                        <label><i class="fas fa-building"></i> <strong>NOME DO CONTRATO/EMPRESA:</strong></label>
                        <input type="text" id="nome-contrato" class="campo-editavel" placeholder="Ex: Cons Vila Romana" value="Cons Vila Romana">
                    </div>
                </div>
            </div>

            <!-- Informa√ß√µes da Loca√ß√£o -->
            <div class="locacao-info">
                <div class="info-row">
                    <div class="info-item">
                        <label><i class="fas fa-truck"></i> <strong>EQUIPAMENTO:</strong></label>
                        <select id="equipamento" class="campo-editavel" onchange="verificarEquipamentoCustomizado()">
                            <option value="BOB CAT">BOB CAT</option>
                            <option value="RETROESCAVADEIRA">RETROESCAVADEIRA</option>
                            <option value="MINI ESCAVADEIRA (08 TON)">MINI ESCAVADEIRA (08 TON)</option>
                            <option value="ESCAVADEIRA HIDR√ÅULICA (18 TON)">ESCAVADEIRA HIDR√ÅULICA (18 TON)</option>
                            <option value="MINI ESCAVADEIRA 03 TON">MINI ESCAVADEIRA 03 TON</option>
                            <option value="CAMINH√ÉO BASCULANT">CAMINH√ÉO BASCULANT</option>
                            <option value="OUTRO">OUTRO (Personalizado)</option>
                        </select>
                        <input type="text" id="equipamento-customizado" placeholder="Digite o equipamento personalizado" class="campo-editavel" style="display: none; margin-top: 5px;">
                    </div>
                    <div class="info-item">
                        <label><i class="fas fa-dollar-sign"></i> <strong>CONTRATO:</strong></label>
                        <input type="text" id="valor-contrato" value="2.500,00" class="campo-editavel campo-valor" placeholder="R$ 2.500,00" oninput="formatarMoedaInput(this); atualizarTabela(); atualizarResumoFinal()">
                    </div>
                    <div class="info-item">
                        <label><i class="fas fa-percentage"></i> <strong>PORCENTAGEM DA HORA:</strong></label>
                        <input type="number" id="porcentagem-hora" value="100" min="0" max="200" step="1" class="campo-editavel" placeholder="100">
                        <small style="display: block; font-size: 0.85em; color: #666; margin-top: 2px;">%</small>
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-item">
                        <label><i class="fas fa-user-hard-hat"></i> <strong>OPERADOR:</strong></label>
                        <input type="text" id="operador" value="ANTONIO PEREIRA" placeholder="Nome do operador" class="campo-editavel">
                    </div>
                </div>
            </div>

            <!-- Informa√ß√µes de Mobiliza√ß√£o -->
            <div class="mobilizacao-info">
                <div class="info-row">
                    <div class="info-item">
                        <label><i class="fas fa-arrow-right"></i> <strong>MOBILIZA√á√ÉO IDA:</strong></label>
                        <input type="text" id="mobilizacao-ida" value="0,00" class="campo-editavel campo-valor" placeholder="R$ 0,00" oninput="formatarMoedaInput(this); atualizarResumoFinal()">
                    </div>
                    <div class="info-item">
                        <label><i class="fas fa-arrow-left"></i> <strong>MOBILIZA√á√ÉO VOLTA:</strong></label>
                        <input type="text" id="mobilizacao-volta" value="0,00" class="campo-editavel campo-valor" placeholder="R$ 0,00" oninput="formatarMoedaInput(this); atualizarResumoFinal()">
                    </div>
                </div>
            </div>
        </div>

        <!-- Painel de Controle Avan√ßado -->
        <div class="painel-controle-avancado">
            <div class="controle-header">
                <h3><i class="fas fa-cogs"></i> Configura√ß√£o de Medi√ß√£o</h3>
            </div>
            
            <!-- Tipo de Medi√ß√£o -->
            <div class="tipo-medicao-section">
                <h4><i class="fas fa-calendar-check"></i> Tipo de Medi√ß√£o</h4>
                <div class="tipo-medicao-grid">
                    <div class="tipo-item">
                        <input type="radio" id="tipo-mensal" name="tipo-medicao" value="mensal" checked>
                        <label for="tipo-mensal">
                            <i class="fas fa-calendar-alt"></i>
                            <span>Mensal</span>
                            <small>Todo o m√™s</small>
                        </label>
                    </div>
                    <div class="tipo-item">
                        <input type="radio" id="tipo-quinzenal" name="tipo-medicao" value="quinzenal">
                        <label for="tipo-quinzenal">
                            <i class="fas fa-calendar-week"></i>
                            <span>Quinzenal</span>
                            <small>15 dias</small>
                        </label>
                    </div>
                    <div class="tipo-item">
                        <input type="radio" id="tipo-diaria" name="tipo-medicao" value="diaria">
                        <label for="tipo-diaria">
                            <i class="fas fa-calendar-day"></i>
                            <span>Di√°ria</span>
                            <small>1 dia</small>
                        </label>
                    </div>
                    <div class="tipo-item">
                        <input type="radio" id="tipo-semanal" name="tipo-medicao" value="semanal">
                        <label for="tipo-semanal">
                            <i class="fas fa-calendar-week"></i>
                            <span>Semanal</span>
                            <small>7 dias</small>
                        </label>
                    </div>
                    <div class="tipo-item">
                        <input type="radio" id="tipo-personalizado" name="tipo-medicao" value="personalizado">
                        <label for="tipo-personalizado">
                            <i class="fas fa-user-cog"></i>
                            <span>Personalizado</span>
                            <small>Dias espec√≠ficos</small>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Configura√ß√µes Espec√≠ficas -->
            <div class="configuracoes-especificas">
                <!-- Mensal -->
                <div id="config-mensal" class="config-section active">
                    <div class="config-item">
                        <label><i class="fas fa-calendar-alt"></i> M√™s/Ano:</label>
                        <input type="month" id="data-mensal" class="controle-input">
                    </div>
                </div>

                <!-- Quinzenal -->
                <div id="config-quinzenal" class="config-section">
                    <div class="config-item">
                        <label><i class="fas fa-calendar-alt"></i> M√™s/Ano:</label>
                        <input type="month" id="data-quinzenal" class="controle-input">
                    </div>
                    <div class="config-item">
                        <label><i class="fas fa-calendar-day"></i> Quinzena:</label>
                        <select id="quinzena" class="controle-select">
                            <option value="1">1¬™ Quinzena (1-15)</option>
                            <option value="2">2¬™ Quinzena (16-31)</option>
                        </select>
                    </div>
                </div>

                <!-- Di√°ria -->
                <div id="config-diaria" class="config-section">
                    <div class="config-item">
                        <label><i class="fas fa-calendar-day"></i> Data:</label>
                        <input type="date" id="data-diaria" class="controle-input">
                    </div>
                </div>

                <!-- Semanal -->
                <div id="config-semanal" class="config-section">
                    <div class="config-item">
                        <label><i class="fas fa-calendar-week"></i> Semana:</label>
                        <input type="week" id="data-semanal" class="controle-input">
                    </div>
                </div>

                <!-- Personalizado -->
                <div id="config-personalizado" class="config-section">
                    <div class="config-item">
                        <label><i class="fas fa-calendar-alt"></i> M√™s/Ano:</label>
                        <input type="month" id="data-personalizado" class="controle-input">
                    </div>
                    <div class="config-item">
                        <label><i class="fas fa-calendar-check"></i> Dias da Semana:</label>
                        <div class="dias-semana-grid">
                            <label class="dia-checkbox">
                                <input type="checkbox" id="segunda" value="1">
                                <span>Seg</span>
                            </label>
                            <label class="dia-checkbox">
                                <input type="checkbox" id="terca" value="2">
                                <span>Ter</span>
                            </label>
                            <label class="dia-checkbox">
                                <input type="checkbox" id="quarta" value="3">
                                <span>Qua</span>
                            </label>
                            <label class="dia-checkbox">
                                <input type="checkbox" id="quinta" value="4">
                                <span>Qui</span>
                            </label>
                            <label class="dia-checkbox">
                                <input type="checkbox" id="sexta" value="5">
                                <span>Sex</span>
                            </label>
                        </div>
                    </div>
                    <div class="config-item">
                        <label><i class="fas fa-hashtag"></i> Quantidade de Dias:</label>
                        <input type="number" id="quantidade-dias" min="1" max="31" value="5" class="controle-input">
                    </div>
                </div>
            </div>

            <!-- Configura√ß√µes de Hor√°rio -->
            <div class="configuracoes-horario">
                <h4><i class="fas fa-clock"></i> Configura√ß√µes de Hor√°rio</h4>
                <div class="horario-grid">
                    <div class="horario-item">
                        <label><i class="fas fa-clock"></i> Horas por Dia √ötil:</label>
                        <select id="horas-dia-util" class="controle-select">
                            <option value="8">8 horas</option>
                            <option value="9" selected>9 horas</option>
                            <option value="10">10 horas</option>
                        </select>
                    </div>
                    <div class="horario-item">
                        <label><i class="fas fa-calendar-day"></i> Horas Sexta-feira:</label>
                        <select id="horas-sexta" class="controle-select">
                            <option value="8" selected>8 horas</option>
                            <option value="9">9 horas</option>
                            <option value="10">10 horas</option>
                        </select>
                    </div>
                    <div class="horario-item">
                        <label><i class="fas fa-sun"></i> Hor√°rio de Entrada:</label>
                        <input type="time" id="horario-entrada" value="07:00" class="controle-input">
                    </div>
                    <div class="horario-item">
                        <label><i class="fas fa-utensils"></i> Hor√°rio de Almo√ßo:</label>
                        <input type="time" id="horario-almoco" value="12:00" class="controle-input">
                    </div>
                    <div class="horario-item">
                        <label><i class="fas fa-undo"></i> Retorno do Almo√ßo:</label>
                        <input type="time" id="horario-retorno" value="13:00" class="controle-input">
                    </div>
                    <div class="horario-item">
                        <label><i class="fas fa-moon"></i> Hor√°rio de Sa√≠da:</label>
                        <input type="time" id="horario-saida" value="17:00" class="controle-input">
                    </div>
                    <div class="horario-item">
                        <label><i class="fas fa-calendar-day"></i> Sa√≠da Sexta-feira:</label>
                        <input type="time" id="horario-saida-sexta" value="16:00" class="controle-input">
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabela Principal -->
        <div class="tabela-principal">
            <div class="tabela-header">
                <h3><i class="fas fa-table"></i> Registro de Horas Trabalhadas</h3>
                <div class="tabela-acoes">
                    <button id="toggle-tabela" class="btn-acao">
                        <i class="fas fa-eye"></i> Mostrar/Ocultar
                    </button>
                </div>
            </div>
            
            <div id="tabela-container" class="tabela-container">
                <table class="cartao-ponto">
                    <thead>
                        <tr class="header-row">
                            <th>M√äS</th>
                            <th colspan="5">APONTAMENTO</th>
                            <th colspan="2">TOTAIS</th>
                            <th colspan="2">DESCONTOS</th>
                        </tr>
                        <tr class="sub-header-row">
                            <th>M√äS/ANO<br><small>DIA</small></th>
                            <th>ENTRADA</th>
                            <th>ALMO√áO</th>
                            <th>RETORNO</th>
                            <th>SA√çDA</th>
                            <th class="soma-diaria">SOMA DIARIA</th>
                            <th class="contrato">CONTRATO</th>
                            <th class="horas-extra">HORAS EXTRA</th>
                            <th class="adc-not">ADC NOT</th>
                        </tr>
                    </thead>
                    <tbody id="tabela-principal">
                        <!-- Linhas ser√£o adicionadas dinamicamente -->
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td><strong>TOTAL</strong></td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td class="soma-diaria" id="total-soma-diaria"><strong>00:00</strong></td>
                            <td class="contrato" id="total-contrato"><strong>00:00</strong></td>
                            <td class="horas-extra" id="total-horas-extra"><strong>00:00</strong></td>
                            <td class="adc-not" id="total-adc-not"><strong>00:00</strong></td>
                        </tr>
                        <tr class="unit-row">
                            <td><strong>VALOR UNIT</strong></td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td class="soma-diaria">
                                <input type="text" id="valor-unit-hora" class="campo-editavel-valor-unit" value="0,00" placeholder="0,00" oninput="formatarMoedaInput(this); atualizarTotais()">
                            </td>
                            <td class="contrato">
                                <input type="text" id="valor-unit-contrato" class="campo-editavel-valor-unit" value="0,00" placeholder="0,00" oninput="formatarMoedaInput(this); atualizarTotais()">
                            </td>
                            <td class="horas-extra">
                                <input type="text" id="valor-unit-horas-extra" class="campo-editavel-valor-unit" value="0,00" placeholder="0,00" oninput="formatarMoedaInput(this); atualizarTotais()">
                            </td>
                            <td class="adc-not">
                                <input type="text" id="valor-unit-adc-not" class="campo-editavel-valor-unit" value="0,00" placeholder="0,00" oninput="formatarMoedaInput(this); atualizarTotais()">
                            </td>
                        </tr>
                        <tr class="rs-total-row">
                            <td><strong>VALOR TOTAL</strong></td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td class="soma-diaria" id="valor-total-soma"><strong>R$ 0,00</strong></td>
                            <td class="contrato" id="valor-total-contrato"><strong>R$ 0,00</strong></td>
                            <td class="horas-extra" id="valor-total-horas-extra"><strong>R$ 0,00</strong></td>
                            <td class="adc-not" id="valor-total-adc-not"><strong>R$ 0,00</strong></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <!-- Bot√µes de Controle -->
        <div class="botoes-controle">
            <div class="botoes-grupo">
                <button id="gerar-medicao" class="btn-futurista">
                    <i class="fas fa-magic"></i> üéØ Gerar Medi√ß√£o
                </button>
                <button id="previsualizar" class="btn-futurista">
                    <i class="fas fa-eye"></i> üëÅÔ∏è Pr√©-visualizar
                </button>
                <button id="limpar-tabela" class="btn-secundario">
                    <i class="fas fa-trash"></i> üóëÔ∏è Limpar Tabela
                </button>
            </div>
            <div class="botoes-grupo">
                <button id="gerar-relatorio" class="btn-futurista">
                    <i class="fas fa-file-alt"></i> üìã Gerar Relat√≥rio
                </button>
                <button id="exportar-pdf" class="btn-futurista">
                    <i class="fas fa-file-pdf"></i> üìÑ Exportar PDF
                </button>
            </div>
        </div>

        <!-- Resumo Final -->
        <div class="resumo-final">
            <div class="resumo-item">
                <h4><i class="fas fa-chart-bar"></i> MEDI√á√ÉO</h4>
                <p><strong>Total de Horas:</strong> <span id="total-horas-final">00:00</span></p>
                <p><strong>Total de Dias:</strong> <span id="total-dias-final">0</span></p>
                <p><strong>Valor Total:</strong> <span id="valor-total-final">R$ 0,00</span></p>
            </div>
            <div class="resumo-item">
                <h4><i class="fas fa-plus-circle"></i> ADICIONAIS</h4>
                <div class="desconto-item">
                    <label><strong>HORAS EXTRAS:</strong></label>
                    <input type="text" id="valor-horas-extras-manual" class="campo-editavel-desconto" value="0,00" placeholder="0,00" oninput="formatarMoedaInput(this); atualizarResumoFinal()">
                    <span id="total-horas-extras-manual">R$ 0,00</span>
                </div>
                <div class="desconto-item">
                    <label><strong>ADC NOTURNO:</strong></label>
                    <input type="text" id="valor-adc-noturno-manual" class="campo-editavel-desconto" value="0,00" placeholder="0,00" oninput="formatarMoedaInput(this); atualizarResumoFinal()">
                    <span id="total-adc-noturno-manual">R$ 0,00</span>
                </div>
            </div>
            <div class="resumo-item">
                <h4><i class="fas fa-minus-circle"></i> DESCONTOS</h4>
                <div class="desconto-item">
                    <label><strong>Combust√≠vel:</strong></label>
                    <input type="text" id="valor-combustivel" class="campo-editavel-desconto" value="0,00" placeholder="0,00" oninput="formatarMoedaInput(this); atualizarDescontos()">
                    <span id="total-combustivel">R$ 0,00</span>
                </div>
                <div class="desconto-item">
                    <label><strong>Outros Descontos:</strong></label>
                    <input type="text" id="valor-outros-descontos" class="campo-editavel-desconto" value="0,00" placeholder="0,00" oninput="formatarMoedaInput(this); atualizarDescontos()">
                    <span id="total-outros-descontos">R$ 0,00</span>
                </div>
                <p><strong>Total Descontos:</strong> <span id="total-descontos-final">R$ 0,00</span></p>
            </div>
            <div class="resumo-item total">
                <h4><i class="fas fa-calculator"></i> TOTAL MEDI√á√ÉO</h4>
                <p><strong><span id="total-medicao-final">R$ 0,00</span></strong></p>
            </div>
        </div>

        <!-- Assinatura -->
        <div class="assinatura-section">
            <h4><i class="fas fa-signature"></i> Assinatura do Operador</h4>
            <div class="canvas-container">
                <canvas id="assinatura-canvas" width="400" height="150"></canvas>
            </div>
        </div>

        <!-- Bot√£o de Instala√ß√£o PWA -->
        <div class="botoes-exportacao">
            <button id="install-app" style="display: none;" class="btn-install">
                <i class="fas fa-download"></i> üì± Instalar App
            </button>
        </div>

        <!-- Rodap√© -->
        <div class="rodape">
            <p><i class="fas fa-map-marker-alt"></i> S√ÉO PAULO, <span id="data-footer"></span> / 2025</p>
            <p class="sistema-info">Controle de Medi√ß√£o - M.A VIANA LOCA√á√ïES E SERVI√áOS - ME</p>
            <p class="versao">Vers√£o 4.0 - Sistema Profissional e Funcional</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="config.js"></script>
    <script src="script.js?v=4.0"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('Service Worker registrado:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('Falha no registro do Service Worker:', error);
                    });
            });
        }
        
        // Verificar status de conex√£o
        function updateConnectionStatus() {
            const statusElement = document.getElementById('connection-status');
            if (statusElement) {
                if (navigator.onLine) {
                    statusElement.innerHTML = '<i class="fas fa-wifi"></i> Online';
                    statusElement.className = 'status-online';
                } else {
                    statusElement.innerHTML = '<i class="fas fa-wifi"></i> Offline';
                    statusElement.className = 'status-offline';
                }
            }
        }
        
        window.addEventListener('online', updateConnectionStatus);
        window.addEventListener('offline', updateConnectionStatus);
        updateConnectionStatus();
    </script>
</body>
</html> Do lado do equipamento